language: java
install: true
cache:
  directories:
    - "~/.m2/repository"

matrix:
  fast_finish: true
  include:
    - jdk: openjdk8
      env:
        - DESC="Build all branches on JDK 8"
        - CMD="mvn clean package gpg:sign -P !release -B --settings cd/mavensettings.xml"
    - jdk: openjdk9
      env:
        - DESC="Build all branches on JDK 9"
        - CMD="mvn clean package gpg:sign -P !release -B --settings cd/mavensettings.xml"
    - jdk: openjdk10
      env:
        - DESC="Build all branches on JDK 10"
        - CMD="mvn clean package gpg:sign -P !release -B --settings cd/mavensettings.xml"
    - jdk: openjdk11
      env:
        - DESC="Build all branches on JDK 11"
        - CMD="mvn clean package gpg:sign -P !release -B --settings cd/mavensettings.xml"

before_script:
  - echo $GPG_SECRET_KEYS | base64 --decode | $GPG_EXECUTABLE --import
  - echo $GPG_OWNERTRUST | base64 --decode | $GPG_EXECUTABLE --import-ownertrust
  - chmod +x ./cd/deploy.sh

script: echo ${CMD}; ${CMD}

#after_success:
#  - "./cd/deploy.sh"